# Desaf√≠o Spring - SocialMeli

## First step
Use endpoint `localhost:8080/users/initialize` 3 users are intialized in memory (in an ``ArrayList`` of `User` objects) with no products. With
the endpoints here provided the API can be used to post items, follow and unfollow users. 

## Endpoints
List of different endpoints, most defined as attributes of static class Router:

### UserController methods (with prefix ``/users``):

#### ``/initialize`` (*not requested*)
- Method: `initializer()`
- Input arguments: none
- What it does: Initalizes 3 Users in memory, in an ArrayList.
- Return value: `ResponseEntity<List<SimpleUserDTO>>`
- Response status: `200 OK` or `400 BAD REQUEST`.

#### ``/users`` (*not requested*)
- Method signature: users()
- Input arguments: none
- What it does: returns users database.
- Return value: `ResponseEntity<List<SimpleUserDTO>>`
- Response status: `200 OK` or `400 BAD REQUEST`.
  
#### ``/{userId}/follow/{userIdToFollow}`` Router.*FOLLOW*
- Method signature: `follow(Integer userId, Integer userIdToFollow)`
- What it does: makes first user to follow second user.
- Return value: `ResponseEntity<String>`, with what action took place.
- Response status: `200 OK` or `400 BAD REQUEST`.
###### Test cases
- localhost:8080/users/1222/follow/1235
- localhost:8080/users/1235/follow/2500
  
#### ``/{userId}/unfollow/{userIdToUnfollow}`` Router.*UNFOLLOW* makes one user unfollow the other.
- Method signature: `unfollow()`
- What it does: makes first user to unfollow second user.
- Return value: `ResponseEntity<String>`, with what action took place.
- Response status: `200 OK` or `400 BAD REQUEST`.
###### Test cases
- localhost:8080/users/1222/unfollow/1235
- localhost:8080/users/1235/unfollow/2500

#### ``/{userId}/followers/count/`` Router.*FOLLOWERS_COUNT*
- Method signature: `followers_count(Integer userId, Integer userIdToUnfollow)`
- What it does: counts users' followers.
- Return value: `ResponseEntity<FollowersCountResponseDTO>`
- Response status: `200 OK` or `400 BAD REQUEST`.
###### Test cases
- localhost:8080/users/1222/followers/count/

#### ``/{userId}/followers/list`` Router.*FOLLOWERS_LIST*
- Method signature: `followers_list(Integer userId, @RequestParam(required=false) String order))`
- Input arguments: 
- What it does:
- Return value:
- Response status: `200 OK` or `400 BAD REQUEST`.
###### Test cases
- localhost:8080/users/1222/followers/list
- localhost:8080/users/1222/followers/list?order=name_desc
- localhost:8080/users/1222/followers/list?order=name_asc

#### ``/{userId}/followed/list`` Router.*FOLLOWED_LIST*
- Method signature: `followed_list(Integer userId, @RequestParam(required=false) String order)`
- What it does:
- Return value:
- Response status: `200 OK` or `400 BAD REQUEST`.
###### Test cases
- localhost:8080/users/2500/followed/list
- localhost:8080/users/1235/followed/list?order=name_desc
- localhost:8080/users/1235/followed/list?order=name_asc

### UserController methods (with prefix ``/products``):

#### ``/newpost`` Router.*NEW_POST*
- Method signature: `newPost(PostRequestDTO postRequestDTO)`
- What it does: adds new post to user. If `product_id` or `id_post` are passed in payload, they are ignored
  and an autogenerated incremental number is assigned to each of them. The number is the same as there is a
  one to one relationship.
- Return value: `ResponseEntity<PostResponseDTO>`
- Response status: `200 OK` or `400 BAD REQUEST`
###### Test cases
- Payload:
  {
  "userId": 1222,
  "date": "09-07-2021",
  "detail": {
  "productName": "Silla Gamer",
  "type": "Gamer",
  "brand": "Racer",
  "color": "Red & Black",
  "notes": "Special Edition"
  },
  "category": 100,
  "price": 1500.50
  }
  
- Payload (BAD USE CASE, wrong date):
  {
  "userId": 1222,
  "date": "09-a-2021",
  "detail": {
  "productName": "Silla Gamer",
  "type": "Gamer",
  "brand": "Racer",
  "color": "Red & Black",
  "notes": "Special Edition"
  },
  "category": 100,
  "price": 1500.50
  }
  - Payload (BAD USE CASE, wrong date):
    {
    "userId": 1222,
    "date": "00-00-2020",
    "detail": {
    "productName": "Silla Gamer",
    "type": "Gamer",
    "brand": "Racer",
    "color": "Red & Black",
    "notes": "Special Edition"
    },
    "category": 100,
    "price": 1500.50
    }


#### ``/newpromopost`` Router.*NEW_PROMO_POST*
- Method signature: `newPromoPost(PromoPostRequestDTO promoPostRequestDTO)`
- What it does: same implementation as ``/newpost``, but payload must include `hasPromo` and `discount` fields.
- Return value: `ResponseEntity<PostResponseDTO>`
- Response status: `200 OK` or `400 BAD REQUEST`

###### Test cases
- Payload:
  {
  "userId": 1222,
  "date": "09-07-2021",
  "detail": {
  "productName": "Silla Gamer",
  "type": "Gamer",
  "brand": "Racer",
  "color": "Red & Black",
  "notes": "Special Edition"
  },
  "category": 100,
  "price": 1500.50,
  "hasPromo": true,
  "discount": 0.25
  }

#### ``/followed/{userId}/list`` Router.*FOLLOWED_POST_LIST*
- Method signature: `sellers_followed_post_list_last2weeks(Integer userId, @RequestParam(required=false) String order) `
- What it does: returns user with ID `userId`'s followers' posts from last 2 weeks.  
- Return value: `ResponseEntity<PostsListResponseDTO>`

###### Test cases
- localhost:8080/users/1235/followed/list

#### ``/{userId}/countPromo/`` Router.*COUNT_PROMO_POST*
- Method signature: `promoPostCount(Integer userId) `
- What it does: returns user with ID `userId`'s amount of promo posts.
- Return value: `ResponseEntity<PromoPostCountResponseDTO>`
- Response status: `200 OK` or `400 BAD REQUEST`

###### Test cases
- localhost:8080/users/1235/followed/list


public static final String COUNT_PROMO_POST = "/{userId}/countPromo/";
public static final String PROMO_POSTS_LIST = "/{userId}/list/";


## Classes

### DTOs
####Request DTOs
- `DetailRequestDTO`, used in Router.*NEW_POST*
- `PostRequestDTO`, used in Router.*NEW_POST*

####Response DTOs
- `DetailResponseDTO`, used in Router.*FOLLOWED_POST_LIST*, Router.*FOLLOWERS_POST_LIST*
- `FollowedListResponseDTO`, used in Router.*FOLLOWED_LIST*
- `FollowersListResponseDTO`used in Router.*FOLLOWERS_LIST*
- `FollowersCountResponseDTO`, used in Router.*FOLLOWERS_COUNT*
- `PostResponseDTO`, used in Router.*FOLLOWED_POST_LIST*
- `PostsListResponseDTO`, used in Router.*FOLLOWED_POST_LIST*, Router.*PROMO_POSTS_LIST*
- `SimpleUserDTO`, used in `/users/users`
- `UserResponseDTO`, used in Router.*FOLLOWED_LIST*, Router.*FOLLOWERS_LIST*

## Setup
- Framework: Spring Boot
- Dependencies:
  ``spring-boot-starter-validation``
  ``spring-boot-starter-web``
  ``spring-boot-devtools``
  ``lombok``


## Notes
- All `userId` (or named similarly) path variables must be positive and integers.
- Following (unfollowing) someone they already followed (did not yet follow) does not raise an exception.
- A user can't follow themselves.
- Dates should be later on in the future than MELI's foundation date.


## Project Status
Project is: Working on the bonus tomorrow. For now, commenting methods and classes in the code. 


## Room for Improvement
There's always room to learn. All feedback will be welcomed :)

Room for improvement:
- Better date validations. Probably there are classes that get the job done more efficiently.
- More personalized error messages, such as specifying what is wrong with the date, apart from the format.
- Making a more flexible date validation, allowing things like `1-6-20` (`d-M-yy` format).